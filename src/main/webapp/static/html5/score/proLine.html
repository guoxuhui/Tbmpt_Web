<html xmlns="http://www.w3.org/1999/xhtml" style="user-select: none;">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0">
<title>项目概况</title>
<link href="../css/main.css?v=20170926" rel="stylesheet">
<link href="../css/weui.min.css?v=20170926" rel="stylesheet">
<link href="../css/home/iconfont.css?v=20170926" rel="stylesheet">
</head>

<body onload="OnLoad()" ontouchstart>

	<div class="weui-toptips weui-toptips_warn js_tooltips">错误提示</div>
	<div class="container" id="container">
			<div class="page home js_show">
				<div class="page tabbar js_show">
					<div class="page__bd" style="height: 100%;">
						<div class="weui-tab">
							<div class="weui-tab__panel">
								
								
								
<div class="m-container band">
	<div class="scoDrive-block0 band">
		<h1 class="block-title">
			<!--<i class="scoDrive-icons title-icon7"></i>--><span class="block-txt" id="prosellinName">项目简称 区间简称 线路</span>
		</h1>
	</div>
	<div class="scoDrive-block1 band" style="padding-top: 0px;">
		<div style="color: gray;">
			<p id="refTitle"> 当前工况</p>
			<p class="ptitle">
				<span id="ptitle_chh" style="font-size: xx-large;color: cornflowerblue;">800</span><span id="ptitle_zhh">/1200环</span>
			</p>
			<div class="tbox1">
				<div class="tiao1" style="width: 0%;"></div>
			</div>
			<p class="pcontent">
				今日已完成2环，预计剩余104天完工
				<br>
				2017-09-13 14:49:00
			</p>
			掘进状态：<span id="zgzt_title" class="weui-badge" >掘进中</span> <span class="weui-badge" style="background-color: #EC971F;">导向偏差预警</span>
		</div>
	</div>
	<div class="scoDrive-block3 band">
		<h1 class="block-title">
			<i class="scoDrive-icons title-icon7"></i><span class="block-txt">周掘进情况</span>
		</h1>
		
<div class="weui-panel weui-panel_access" style="background-color: rgba(255, 255, 255, 0);">
	<div class="weui-panel__bd">
		<a href="javascript:;" class="weui-media-box weui-media-box_appmsg" style="padding: 3px;">
			<div class="weui-media-box__bd">
				<h4 class="weui-media-box__title" style="color: gray;">
					<div class="weui-flex" style="padding: 0px;font-size: 13px;">
			            <div class="weui-flex__item"><div class="placeholder"><span id="jd_title_1">9月26日</span> 完成<span style="font-size: x-large;"> <span id="jd_value_1">3</span> </span>环</div></div>
			            <div class="weui-flex__item">
			            		<div class="placeholder">
				            	<div class="weui-progress__bar" style="height: 12px;background-color: rgba(255, 255, 255, 0);">
				                <div id="jd_progress_1" class="weui-progress__inner-bar js_progress" style="width: 30%;background-color: lightskyblue;"></div>
				            </div>
			            		</div>
			            </div>
			       </div>
				</h4>
				<p class="weui-media-box__desc">
					
				</p>
			</div>
		</a>
		<a href="javascript:;" class="weui-media-box weui-media-box_appmsg" style="padding: 3px;">
			<div class="weui-media-box__bd">
				<h4 class="weui-media-box__title" style="color: gray;">
					<div class="weui-flex" style="padding: 0px;font-size: 13px;">
			            <div class="weui-flex__item"><div class="placeholder"><span id="jd_title_2">9月25日</span> 完成<span style="font-size: x-large;"> <span id="jd_value_2">1</span> </span>环</div></div>
			            <div class="weui-flex__item">
			            		<div class="placeholder">
				            	<div class="weui-progress__bar" style="height: 12px;background-color: rgba(255, 255, 255, 0);">
				                <div id="jd_progress_2" class="weui-progress__inner-bar js_progress" style="width: 10%;background-color: lightskyblue;"></div>
				            </div>
			            		</div>
			            </div>
			       </div>
				</h4>
				<p class="weui-media-box__desc">
					
				</p>
			</div>
		</a>
		<a href="javascript:;" class="weui-media-box weui-media-box_appmsg" style="padding: 3px;">
			<div class="weui-media-box__bd">
				<h4 class="weui-media-box__title" style="color: gray;">
					<div class="weui-flex" style="padding: 0px;font-size: 13px;">
			            <div class="weui-flex__item"><div class="placeholder"><span id="jd_title_3">9月24日</span> 完成<span style="font-size: x-large;"> <span id="jd_value_3">2</span> </span>环</div></div>
			            <div class="weui-flex__item">
			            		<div class="placeholder">
				            	<div class="weui-progress__bar" style="height: 12px;background-color: rgba(255, 255, 255, 0);">
				                <div id="jd_progress_3" class="weui-progress__inner-bar js_progress" style="width: 20%;background-color: lightskyblue;"></div>
				            </div>
			            		</div>
			            </div>
			       </div>
				</h4>
				<p class="weui-media-box__desc">
					
				</p>
			</div>
		</a>
		<a href="javascript:;" class="weui-media-box weui-media-box_appmsg" style="padding: 3px;">
			<div class="weui-media-box__bd">
				<h4 class="weui-media-box__title" style="color: gray;">
					<div class="weui-flex" style="padding: 0px;font-size: 13px;">
			            <div class="weui-flex__item"><div class="placeholder"><span id="jd_title_4">9月23日</span> 完成<span style="font-size: x-large;"> <span id="jd_value_4">0</span> </span>环</div></div>
			            <div class="weui-flex__item">
			            		<div class="placeholder">
				            	<div class="weui-progress__bar" style="height: 12px;background-color: rgba(255, 255, 255, 0);">
				                <div id="jd_progress_4" class="weui-progress__inner-bar js_progress" style="width: 00%;background-color: lightskyblue;"></div>
				            </div>
			            		</div>
			            </div>
			       </div>
				</h4>
				<p class="weui-media-box__desc">
					
				</p>
			</div>
		</a>
		<a href="javascript:;" class="weui-media-box weui-media-box_appmsg" style="padding: 3px;">
			<div class="weui-media-box__bd">
				<h4 class="weui-media-box__title" style="color: gray;">
					<div class="weui-flex" style="padding: 0px;font-size: 13px;">
			            <div class="weui-flex__item"><div class="placeholder"><span id="jd_title_5">9月22日</span> 完成<span style="font-size: x-large;"> <span id="jd_value_5">0</span> </span>环</div></div>
			            <div class="weui-flex__item">
			            		<div class="placeholder">
				            	<div class="weui-progress__bar" style="height: 12px;background-color: rgba(255, 255, 255, 0);">
				                <div id="jd_progress_5" class="weui-progress__inner-bar js_progress" style="width: 00%;background-color: lightskyblue;"></div>
				            </div>
			            		</div>
			            </div>
			       </div>
				</h4>
				<p class="weui-media-box__desc">
					
				</p>
			</div>
		</a>
		<a href="javascript:;" class="weui-media-box weui-media-box_appmsg" style="padding: 3px;">
			<div class="weui-media-box__bd">
				<h4 class="weui-media-box__title" style="color: gray;">
					<div class="weui-flex" style="padding: 0px;font-size: 13px;">
			            <div class="weui-flex__item"><div class="placeholder"><span id="jd_title_6">9月21日</span> 完成<span style="font-size: x-large;"> <span id="jd_value_6">1</span> </span>环</div></div>
			            <div class="weui-flex__item">
			            		<div class="placeholder">
				            	<div class="weui-progress__bar" style="height: 12px;background-color: rgba(255, 255, 255, 0);">
				                <div id="jd_progress_6" class="weui-progress__inner-bar js_progress" style="width: 10%;background-color: lightskyblue;"></div>
				            </div>
			            		</div>
			            </div>
			       </div>
				</h4>
				<p class="weui-media-box__desc">
					
				</p>
			</div>
		</a>
		<a href="javascript:;" class="weui-media-box weui-media-box_appmsg" style="padding: 3px;">
			<div class="weui-media-box__bd">
				<h4 class="weui-media-box__title" style="color: gray;">
					<div class="weui-flex" style="padding: 0px;font-size: 13px;">
			            <div class="weui-flex__item"><div class="placeholder"><span id="jd_title_7">9月20日</span> 完成<span style="font-size: x-large;"> <span id="jd_value_7">2</span> </span>环</div></div>
			            <div class="weui-flex__item">
			            		<div class="placeholder">
				            	<div class="weui-progress__bar" style="height: 12px;background-color: rgba(255, 255, 255, 0);">
				                <div id="jd_progress_7" class="weui-progress__inner-bar js_progress" style="width: 20%;background-color: lightskyblue;"></div>
				            </div>
			            		</div>
			            </div>
			       </div>
				</h4>
				<p class="weui-media-box__desc">
					
				</p>
			</div>
		</a>
	</div>
</div>
	</div>
	

</div>
								
								
								
							</div>
							<div class="weui-tabbar">
								<a id="fun_jqcs_jj" href="javascript:;" class="weui-tabbar__item">
                                    <img src="../image/参数.png" alt="" class="weui-tabbar__icon">
									<p class="weui-tabbar__label">推进系统</p>
								</a>
								<a id="fun_jqcs_dx" href="javascript:;" class="weui-tabbar__item">
                                    <img src="../image/导向.png" alt="" class="weui-tabbar__icon">
									<p class="weui-tabbar__label">导向系统</p>
								</a>
								<a id="fun_spjk" href="javascript:;" class="weui-tabbar__item">
									<img src="../image/视频.png" alt="" class="weui-tabbar__icon">
									<p class="weui-tabbar__label">视频监控</p>
								</a>
								<a id="fun_xmxx" href="javascript:;" class="weui-tabbar__item">
                        				<img src="../image/项目.png" alt="" class="weui-tabbar__icon">
									<p class="weui-tabbar__label">项目信息</p>
								</a>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>


	<script src="../js/jquery.min.js"></script>
	<script src="../js/jshelper.js"></script>
	<script src="../js/common-1.0.2.js"></script>

	<script type="text/javascript">
		var i1 = 0,
		i2 = 0,
		i3 = 0;

		function OnLoad() {
			document.documentElement.style.webkitTouchCallout = "none"; //禁止弹出菜单
			document.documentElement.style.webkitUserSelect = "none"; //禁止选中
		}
		
		$(function() {
		
			$("#refTitle").click(function() {
				var hrefa = location.href;
				location.href = hrefa;
			});
			$("#fun_jqcs").click(function() {
				Android.openMachineData();
				//location.href = "/open/jqsj/machineDatePage?proId=b89bc80ae8894c2a84f33ffef04d411c";
			});
			$("#fun_jqcs_jj").click(function() {
				Android.openMachineData_jj();
				//location.href = "/open/jqsj/machineDatePage?proId=b89bc80ae8894c2a84f33ffef04d411c";
			});
			$("#fun_jqcs_dx").click(function() {
				Android.openMachineData_dx();
				//location.href = "/open/jqsj/machineDatePage?proId=b89bc80ae8894c2a84f33ffef04d411c";
			});
			$("#fun_spjk").click(function() {
				Android.openVideo();
				//location.href = "../video/videoList.html";
			});
			$("#fun_xmxx").click(function() {
				Android.openProInfo();
				//location.href = "../video/videoList.html";
			});
			loadDriveInfo(true);
		
			setInterval(loadDriveInfo, 10000); // 注意函数名没有引号和括弧！ 
		
		});
		
		function loadDriveInfo(falt) {
			var lid = jshelper.getUrlQuery("lid");
		
			var params = {
				lid: lid
			};
			$
				.ajax({
					type: "get",
					url: "/open/jqsj/DrivingBehavior",//"../DrivingBehavior.json", //"/open/jqsj/DrivingBehavior",
					data: params
				})
				.done(
					function(msg) {
						msg = strToJson(msg);
						if(msg.res) {
		
							if(msg.result.LineData) {
		
								var LineData = msg.result.LineData;
								var TbmData = msg.result.TbmData;
								var GeoData = msg.result.GeoData;
								var WorData = msg.result.WorData;
								
								var com = "今日已完成2环，预计剩余" + TbmData.days +"天完工";
								com = com + "<br>" +TbmData.dataTime;
								$(".pcontent").html(com);
		
								xh1(parseInt(TbmData.finish)); //加载质量进度条
		
								$("#prosellinName").html(
									LineData.Pro_Name + " " +
									LineData.Section_Name +" " +
									LineData.Line_Name);
								
								//盾构机状态
								if (TbmData.zgzt_jj == "1") {
									$("#zgzt_title").html("掘进中");
								}else
								if (TbmData.zgzt_ph == "1") {
									$("#zgzt_title").html("拼装中");
								}else
								if (TbmData.zgzt_stop == "1") {
									$("#zgzt_title").html("停机中");
								}
									
								$("#ptitle_chh").html(TbmData.currRing);
								$("#ptitle_zhh").html("/"+TbmData.ring_Count+"环");
		
								$("#ageRing").html(
									TbmData.ageRing + "环/天");
								$("#currRing").html(
									TbmData.currRing + "环");
								$("#finish").html(TbmData.finish + "%");
		
								for(var i=0;i<WorData.length;i++){
									$("#jd_title_"+(i+1)).html(WorData[i].work_date);
									$("#jd_value_"+(i+1)).html(WorData[i].work_hs_sum);
									$("#jd_progress_"+(i+1)).css("width", WorData[i].work_hs_sum + "0%");
								}
								
							}
						}
					})
		}
		
		//进度条
		/*add——创建tbx下的div加文字和变宽度的方法*/
		function add1(i) {
			var tbox1 = $(".tbox1");
			var tiao1 = $(".tiao1");
			tiao1.css("width", i + "%");
			tiao1.html("已完成"+i + "%");
		}
		
		/*创建方法（i++循环起来）*/
		function xh1(data) {
			if(i1 <= data) {
				add1(i1);
				i1++;
				setTimeout(function() {
					xh1(data);
				}, 30);
			}
		}
		
		function strToJson(str) {
			var json = eval('(' + str + ')');
			return json;
		}
	</script>

</body>

</html>